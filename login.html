<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login - Toledo Service</title>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="flex items-center justify-center min-h-screen bg-gradient-to-br from-gray-800 to-blue-500">
    <!-- Header fixo -->
  <!-- Header fixo -->
<header class="fixed top-0 inset-x-0 z-50 bg-gray-900 backdrop-blur border-b border-gray-200">
  <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
    <a href="index.html" class="flex items-center gap-2">
      <img src="images/logo.png" alt="Logo Serviços Toledo" class="h-8">
      <span class="text-2xl font-extrabold tracking-tight text-white">ServiçosToledo</span>
    </a>

    <!-- Menu Desktop -->
    <nav class="hidden md:flex items-center gap-8 text-white font-semibold">
      <a href="index.html" class="hover:text-white">Início</a>
      <a href="contato.html" class="hover:text-white">Contato</a>
      <a href="buscaprestador.html" class="hover:text-white">Buscar Prestador</a>
      <a href="servicos.html" class="hover:text-white">Verificar Serviços</a>
      <a href="prestadores.html"
         class="text-white bg-blue-600 px-4 py-2 rounded-lg hover:bg-blue-700 transition">
        Quero me cadastrar
      </a>

      <!-- Auth Section -->
      <div id="auth-desktop" class="flex items-center space-x-4">
        <!-- Botão login -->
        <a id="login-btn-desktop" href="login.html" 
           class="px-4 py-2 bg-green-600 text-white rounded-lg shadow hover:bg-green-700 transition">
          Entrar
        </a>
        <!-- Info do usuário -->
        <div id="user-info-desktop" class="hidden items-center space-x-3">
          <img id="user-pic-desktop" class="w-8 h-8 rounded-full border" alt="User">
          <span id="user-name-desktop" class="text-white font-semibold"></span>
          <button id="logout-btn-desktop" 
            class="px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700">
            Sair
          </button>
        </div>
      </div>
    </nav>

    <!-- Botão menu mobile -->
    <button id="menuBtn"
      class="md:hidden inline-flex items-center justify-center h-10 w-10 rounded-lg border border-white hover:bg-gray-800">
      <svg class="h-5 w-5" fill="none" stroke="white" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-width="2" d="M4 8h16M4 16h16" />
      </svg>
    </button>
  </div>

  <!-- Menu Mobile -->
  <div id="mobileMenu" class="md:hidden hidden px-6 pb-4">
    <div class="flex flex-col gap-3 font-semibold">
      <a href="index.html" class="py-2 border-b text-white">Início</a>
      <a href="buscaprestador.html" class="py-2 border-b text-white">Buscar Prestador</a>
      <a href="contato.html" class="py-2 border-b text-white">Contato</a>
      <a href="servicos.html" class="py-2 border-b text-white">Verificar Serviços</a>
      <a href="prestadores.html" class="py-2 text-white bg-blue-600 rounded-lg text-center">Quero me cadastrar</a>

      <!-- Auth Section Mobile -->
      <div id="auth-mobile" class="flex items-center space-x-4">
        <a id="login-btn-mobile" href="login.html" 
           class="px-4 py-2 bg-green-600 text-white rounded-lg shadow hover:bg-green-700 transition w-full text-center">
          Entrar
        </a>
        <div id="user-info-mobile" class="hidden items-center space-x-3 w-full justify-between">
          <div class="flex items-center gap-2">
            <img id="user-pic-mobile" class="w-8 h-8 rounded-full border" alt="User">
            <span id="user-name-mobile" class="text-white font-semibold"></span>
          </div>
          <button id="logout-btn-mobile" 
            class="px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700">
            Sair
          </button>
        </div>
      </div>
    </div>
  </div>
</header>

<script>
  // Controle do menu mobile
  const menuBtn = document.getElementById('menuBtn');
  const mobileMenu = document.getElementById('mobileMenu');
  menuBtn.addEventListener('click', () => { 
    mobileMenu.classList.toggle('hidden'); 
  });

  // Função para carregar usuário
  function loadUser() {
    const user = JSON.parse(localStorage.getItem("user"));

    // Desktop
    const loginBtnDesktop = document.getElementById("login-btn-desktop");
    const userInfoDesktop = document.getElementById("user-info-desktop");
    const userNameDesktop = document.getElementById("user-name-desktop");
    const userPicDesktop = document.getElementById("user-pic-desktop");
    const logoutBtnDesktop = document.getElementById("logout-btn-desktop");

    // Mobile
    const loginBtnMobile = document.getElementById("login-btn-mobile");
    const userInfoMobile = document.getElementById("user-info-mobile");
    const userNameMobile = document.getElementById("user-name-mobile");
    const userPicMobile = document.getElementById("user-pic-mobile");
    const logoutBtnMobile = document.getElementById("logout-btn-mobile");

    if (user) {
      // Mostrar infos
      loginBtnDesktop.classList.add("hidden");
      userInfoDesktop.classList.remove("hidden");
      userNameDesktop.textContent = user.name;
      userPicDesktop.src = user.picture;

      loginBtnMobile.classList.add("hidden");
      userInfoMobile.classList.remove("hidden");
      userNameMobile.textContent = user.name;
      userPicMobile.src = user.picture;

      // Logout
      logoutBtnDesktop.addEventListener("click", () => {
        localStorage.removeItem("user");
        window.location.reload();
      });
      logoutBtnMobile.addEventListener("click", () => {
        localStorage.removeItem("user");
        window.location.reload();
      });
    }
  }

  document.addEventListener("DOMContentLoaded", loadUser);
</script>
  <div class="bg-white p-8 rounded-2xl shadow-2xl w-full max-w-md text-center">
    <!-- Logo / Nome -->
    <h1 class="text-3xl font-extrabold mb-6 text-gray-800">Toledo Service</h1>
    <p class="text-gray-600 mb-6">Entre com sua conta Google para continuar</p>
    
    <!-- Container do botão do Google -->
    <div id="g_id_onload"
         data-client_id="857188544714-i3qunn9vkjna8r3cg22nruet2pt41oc0.apps.googleusercontent.com"
         data-context="signin"
         data-ux_mode="popup"
         data-callback="handleCredentialResponse"
         data-auto_select="false">
    </div>

    <div class="g_id_signin"
         data-type="standard"
         data-shape="rectangular"
         data-theme="outline"
         data-text="signin_with"
         data-size="large"
         data-logo_alignment="left">
    </div>

    <!-- Link de retorno -->
    <p class="mt-6 text-sm text-gray-500">
      <a href="index.html" class="text-green-600 hover:underline">← Voltar ao site</a>
    </p>
  </div>

  <script>
    // Callback quando o login for concluído
    function handleCredentialResponse(response) {
      console.log("JWT Token recebido:", response.credential);
      // Aqui você pode enviar o token para o backend validar
      alert("Login com Google realizado com sucesso!");
    }
  </script>
  <script>
  // Decodifica o token JWT para pegar os dados do usuário
  function decodeJwtResponse(token) {
    const base64Url = token.split('.')[1];
    const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
    const jsonPayload = decodeURIComponent(window.atob(base64).split('').map(function(c) {
      return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
    }).join(''));
    return JSON.parse(jsonPayload);
  }

  function handleCredentialResponse(response) {
    const userData = decodeJwtResponse(response.credential);
    console.log("Usuário logado:", userData);

    // Salva no navegador
    localStorage.setItem("user", JSON.stringify(userData));

    // Redireciona para a página inicial
    window.location.href = "index.html";
  }
  
</script>

</body>
</html>
